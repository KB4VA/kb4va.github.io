{"version":3,"sources":["app/components/Image.js","app/hooks/useImageSize.js","utils/inferColumnTypeFromData.js","database/loadDatabase.js","database/views.js","utils/queryRecommendations.js","utils/generateDataStructureFromFields.js","database/figures.js","store/index.js","app/hooks/useView.js","app/components/FigImage.js","app/views/FigureViewer/index.js","app/hooks/useFigure.js","app/views/QueryPanel/QueryItem.js","app/views/QueryPanel/DualSwitch.js","res/theme.js","res/const.js","res/index.js","res/strings.js","res/colors.js","app/views/QueryPanel/ItemSelect.js","app/views/QueryPanel/FieldCheckbox.js","app/views/QueryPanel/SpecInput.js","app/views/QueryPanel/index.js","app/components/ActionBox.js","app/views/RecommendationsPanel/Recommendation.js","app/views/RecommendationsPanel/index.js","app/components/Panel.js","app/components/AspectRatioKeeper.js","app/components/Waiting.js","app/views/Introduction.js","app/App.js","index.js"],"names":["useStyles","makeStyles","theme","image","overflow","width","height","display","justifyContent","alignItems","textAlign","flexWrap","loading","flex","lineHeight","imgBlock","position","props","img","transition","opacity","loaded","inject","observer","src","alt","className","onLoad","type","overlay","useState","setLoaded","cRef","useRef","useSize","cw","ch","nw","nh","setNaturalSize","setSize","useEffect","w","h","scale","Math","max","min","loadedImage","e","target","naturalWidth","naturalHeight","useImageSize","classes","clsx","ref","Typography","draggable","inferColumnTypeFromData","colData","field","lowerCaseField","toLowerCase","word","endsWith","isTimeField","d","isNaN","console","log","isAllNumber","diff","i","length","isOrderField","loadDatabase","path","initialData","data","current","isLoading","fetch","then","res","json","ensureLoading","handler","setTimeout","packageJson","homepage","viewMatchCondition","view","condition","isArray","spec","Array","compareSpec","specInCondition","specInView","match","allCondMatch","viewIndex","forEach","itemCondition","curCondMatch","itemView","index","indexOf","push","Object","keys","key","undefined","typeMatch","typeInCondition","typeInView","item","includes","typeMatchAll","specMatch","specItem","specification","typeInCondition1","typeInCondition2","item2","viewItem","item1","combineInCondition","typeMatchCombine","actions","targets","actionTargets","compositions","marks","channels","datas","dataTypes","aggregates","vis","task","sum","queryRecommendations","Promise","resolve","views","recommendations","isMatch","rankScore","viewId","queryViews","generateDataStructureFromFields","selectedFields","allFields","types","t","name","map","join","store","waiting","startWait","endWait","uploadData","input","document","createElement","accept","multiple","onchange","files","fileHandlers","_","fId","file","Papa","parse","header","complete","errors","err","code","row","pop","fileName","fields","meta","f","content","all","resetQueryParams","setData","fieldNames","flat","setFields","click","newData","newFields","setFieldType","isTableViewerOpen","showTableViewer","closeTableViewer","isReadMeOpen","handleReadMeOpen","handleReadMeClose","vegaSpecInter","JSON","stringify","setSpecInter","newValue","queryParams","isNonStructural","dataStructure","useSpec","setQueryParams","newParams","generateRecommendationsFromQueryParams","getViewData","figFile","viewFile","figBox","figCaption","figId","relationText","note","queryViewById","setRecommendations","newRecommendations","viewDetail","showViewDetail","initViewId","closeViewDetail","selectedViews","selectView","find","rec","setViews","newViews","removeView","filter","v","importViews","fr","FileReader","onload","result","importView","viewList","readAsText","exportViews","text","vId","blob","Blob","saveAs","figures","getFigureData","figs","fig","title","caption","viewIds","queryFigureById","makeAutoObservable","this","window","onbeforeunload","preventDefault","error","onunload","useView","x","y","setView","figImage","maxWidth","box","backgroundColor","alpha","palette","primary","main","FigImage","pos","left","top","Paper","elevation","style","figureViewer","padding","maxHeight","light","paddingTop","spacing","margin","bigImage","viewImage","imageLimitation","info","marginTop","paddingBottom","selected","boxShadow","dark","useTheme","select","figure","setFigure","useFigure","Dialog","open","onClose","fullWidth","DialogContent","variant","defaultLanguage","options","lineNumbers","readOnly","background","value","atArray","actionTarget","action","replace","split","beautifyActionTarget","onClick","solid","placeholder","flexBasis","flexGrow","flexDirection","shrinkable","flexShrink","minHeight","Item","children","React","primaryColor","scrollColor","R","strings","systemName","default","MuiAppBar","overrides","colorPrimary","color","MuiTypography","subtitle1","fontWeight","MuiCheckbox","MuiSwitch","MuiTooltip","tooltip","fontSize","whiteSpace","MuiCssBaseline","borderRadius","lighten","darken","const","consume","label","produce","search","query","Attributes","Graphs","colors","ItemSelect","onChange","twolevel","wrapper","createRef","TextField","SelectProps","renderValue","val","idx","findIndex","option","val2label","MenuItem","Checkbox","checked","ListItemText","l1","ListSubheader","memo","fieldCheckbox","border","shape","minWidth","selectInput","editable","onChangeType","setOpen","handleOpen","Button","size","noWrap","disabled","Select","onOpen","Input","fieldTypes","fT","FormControlLabel","control","Switch","selectOnLineNumbers","event","defaultValue","queryPanel","itemContainer","QueryItem","sort","a","b","endIcon","Refresh","actionBox","right","ActionBox","aId","IconButton","icon","recommendation","imagePreview","popover","pointerEvents","paper","popoverText","verticalAlign","marginLeft","anchorEl","setAnchorEl","handlePopoverClose","Boolean","Loupe","onDragStart","ev","dataTransfer","dropEffect","onMouseEnter","currentTarget","onMouseLeave","Popover","anchorOrigin","vertical","horizontal","transformOrigin","disableRestoreFocus","recommendationsPanel","paddingLeft","paddingRight","gridTemplateColumns","floor","gridTemplateRows","gap","panel","bottom","outerArea","innerContainer","transform","ratio","rootRef","getMaxBox","ctnW","ctnH","backdrop","zIndex","drawer","Backdrop","CircularProgress","DialogTitle","root","AppBar","Toolbar","component","bgColor","ReactDOM","render","StrictMode","createTheme","CssBaseline","getElementById"],"mappings":"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","file":"static/js/main.f2125689.chunk.js","sourcesContent":["import React, {useRef, useState} from 'react';\nimport {makeStyles, Typography} from \"@material-ui/core\";\nimport {inject, observer} from \"mobx-react\";\nimport clsx from \"clsx\";\nimport useImageSize from \"../hooks/useImageSize\";\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\n\nconst useStyles = makeStyles(theme => ({\n    image: {\n        overflow: 'hidden',\n        width: '100%',\n        height: '100%', \n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        textAlign: 'center',\n        flexWrap: 'wrap',\n    },\n    loading: {\n        flex: '0 0 100%',\n        width: '100%',\n        textAlign: 'center',\n        height: '100%',\n        lineHeight: 10,\n    },\n    imgBlock: {\n        position: 'relative',\n        width: props => props.width || \"100%\",\n        height: props => props.height || \"100%\",\n    },\n    img: {\n        flex: '0 0 auto',\n        width: props => props.width || \"100%\",\n        height: props => props.height || \"100%\",\n        transition: 'opacity .3s linear',\n        \"&$loaded\": {\n            opacity: 1,\n        }\n    },\n    loaded: {},\n}));\n\nfunction Image({src, alt, className, onLoad, type = \"fill\", overlay, ...props}) {\n    const [loaded, setLoaded] = useState(false);\n\n    const cRef = useRef();\n    const {width, height, loadedImage} = useImageSize(type, cRef);\n\n    const classes = useStyles({width, height});\n    return <div className={clsx(classes.image, className)}\n                ref={cRef}>\n        {!loaded && <Typography className={classes.loading}>loading</Typography>}\n        <div className={classes.imgBlock}>\n            <LazyLoadImage src={src}\n                 alt={alt}\n                 draggable={false}\n                 className={clsx(classes.img, {\n                     [classes.loaded]: loaded\n                 })}\n                 onLoad={e => {\n                     setLoaded(true);\n                     loadedImage(e);\n                     onLoad && onLoad(e);\n                 }}\n                 {...props}/>\n                \n            {overlay}\n        </div>\n    </div>\n}\n\nexport default inject()(observer(Image));\n","import {useSize} from \"ahooks\";\nimport {useEffect, useState} from \"react\";\n\nexport default function useImageSize(type, cRef) {\n    const {width: cw, height: ch} = useSize(cRef);\n    const [[nw, nh], setNaturalSize] = useState([0, 0]);\n    const [[width, height], setSize] = useState([cw, ch]);\n\n    useEffect(() => {\n        let w = cw, h = ch;\n        if (type === \"fill\") {\n            const scale = Math.max(cw / nw, ch / nh);\n            w = nw * scale;\n            h = nh * scale;\n        }\n        if (type === \"center\") {\n            const scale = Math.min(cw / nw, ch / nh);\n            w = nw * scale;\n            h = nh * scale;\n        }\n        if (type === \"fullHeight\") {\n            const scale = ch / nh;\n            w = nw * scale;\n            h = nh * scale;\n        }\n\n        setSize([w, h]);\n    }, [ch, cw, nh, nw, type])\n\n    const loadedImage = (e) => {\n        const nw = e.target.naturalWidth, nh = e.target.naturalHeight;\n        setNaturalSize([nw, nh]);\n    }\n\n    return {width, height, loadedImage};\n}\n","const isTimeField = (colData, field) => {\n    const timeWords = [\"year\", \"month\", \"day\", \"hour\", \"minute\", \"second\", \"date\", \"time\", \"timestamp\", \"timestamps\"];\n    const lowerCaseField = field.toLowerCase();\n    for (const word of timeWords) {\n        if (lowerCaseField.endsWith(word))\n            return true;\n    }\n    return false;\n}\n\nconst isAllNumber = (colData, field) => {\n    for (const d of colData)\n        if (isNaN(d)) {\n            console.log(`Field ${field} has non-numerical data ${d}.`);\n            return false;\n        }\n    return true;\n}\n\nconst isOrderField = (colData, field) => {\n    const orderWords = [\"index\", \"idx\", \"id\", \"i\"];\n    const lowerCaseField = field.toLowerCase();\n    for (const word of orderWords) {\n        if (lowerCaseField.endsWith(word)) {\n            console.log(`Field ${field} is regarded as order field because of the field name includes ${word}.`);\n            return true;\n        }\n    }\n\n    const diff = colData[0];\n    for (let i = 1; i < colData.length; i++)\n        if (i + diff !== colData[i])\n            return false;\n\n    console.log(`Field ${field} is regarded as order field because the data is in order.`);\n    return true;\n}\n\nexport default function inferColumnTypeFromData(colData, field) {\n    if (isTimeField(colData, field)) return \"T\";\n    if (isAllNumber(colData, field)) {\n        if (isOrderField(colData, field)) return \"O\";\n        else return \"Q\";\n    }\n    return \"N\";\n}\n","export default function loadDatabase(path, initialData) {\n    const data = {\n        current: initialData,\n    };\n\n    let isLoading = true;\n    fetch(path)\n      .then(res => res.json())\n      .then(res => {\n          data.current = res;\n          isLoading = false;\n      });\n\n    const ensureLoading = handler => {\n        if (!isLoading) handler();\n        else {\n            setTimeout(() => ensureLoading(handler), 500);\n        }\n    }\n    return {data, ensureLoading}\n}\n","import loadDatabase from \"./loadDatabase\";\nimport packageJson from \"../../package.json\";\n\nconst {data, ensureLoading} = loadDatabase(`${packageJson.homepage}/knowledgeBase.json`, []);\n// const { data, ensureLoading } = loadDatabase(`${process.env.PUBLIC_URL}/knowledgeBase.json`, []);\n\nlet count = 1\n\nconst viewMatchCondition = (view, condition) => {\n\n\n    const isArray = (spec) =>{\n        return typeof (spec) == \"object\" && Array.isArray(spec)\n    }\n\n    const compareSpec = (specInCondition, specInView) => {\n        if (specInCondition === \"*\") return true\n        else if (specInView == specInCondition) return true\n        else if (typeof (specInView) != typeof (specInCondition)) return false\n        else if (typeof (specInView) == \"string\" && specInView != specInCondition) return false\n        // console.log(\"prev\", specInCondition, specInView)\n        let match = true\n\n        if (isArray(specInCondition) && isArray(specInView)){\n            let allCondMatch = true\n            let viewIndex = []\n            specInCondition.forEach((itemCondition) => {\n                if (allCondMatch){\n                    let curCondMatch = false\n                    specInView.forEach((itemView, index) => {\n                        if (viewIndex.indexOf(index) == -1 && !curCondMatch){\n                            if (compareSpec(itemCondition, itemView)){\n                                curCondMatch = true\n                                viewIndex.push(index)\n                            }\n                        }\n                    })\n                    if (!curCondMatch){\n                        allCondMatch = false\n                    }\n                }\n            })\n            return allCondMatch\n        }\n        else if (typeof (specInCondition) == \"object\"){\n            Object.keys(specInCondition).forEach((key) => {\n                if (specInView[key] == undefined) match = false\n                else if (match) match = compareSpec(specInCondition[key], specInView[key])\n            })\n        }\n        return match\n    }\n\n    const specMatch = (specInCondition, specInView) => {\n        if (specInCondition == {}) return true\n        let match = false\n        // compare current level\n        match = compareSpec(specInCondition, specInView)\n        // console.log(match)\n        if (match) return true\n        else if (typeof (specInView) == \"string\") return match\n        else if (isArray(specInView)){\n            specInView.forEach((specItem) => {\n                if (!match) match = specMatch(specInCondition, specItem)\n            })\n        }\n        else if (typeof (specInView) == \"object\") {\n            Object.keys(specInView).forEach((key) => {\n                if (!match) match = specMatch(specInCondition, specInView[key])\n            })\n        }\n        return match\n    }\n\n\n    const typeMatch = (typeInCondition, typeInView) => {\n        if (typeInCondition.length === 0) return true\n        let match = false\n        typeInCondition.forEach(item => {\n            // console.log(typeInView.includes(item))\n            if (typeInView.includes(item)) match = true;\n        })\n        return match;\n    }\n\n    const typeMatchAll = (typeInCondition, typeInView) => {\n        if (typeInCondition.length === 0) return true\n        let match = true\n        typeInCondition.forEach(item => {\n            // console.log(typeInView.includes(item))\n            if (!typeInView.includes(item)) match = false\n        })\n        return match;\n    }\n\n    const typeMatchCombine = (typeInCondition1, typeInCondition2, typeInView) => {\n        let match = false\n        if (typeInCondition1.length === 0 && typeInCondition2.length === 0) {\n            match = true\n        }\n        else if (typeInCondition1.length === 0) {\n            typeInCondition2.forEach(item2 => {\n                typeInView.forEach(viewItem => {\n                    if (viewItem.includes(item2)) match = true\n                })\n            })\n        }\n        else if (typeInCondition2.length === 0) {\n            typeInCondition1.forEach(item1 => {\n                typeInView.forEach(viewItem => {\n                    if (viewItem.includes(item1)) match = true\n                })\n            })\n        }\n        else {\n            typeInCondition1.forEach(item1 => {\n                typeInCondition2.forEach(item2 => {\n                    const combineInCondition = `${item1}:${item2}`\n                    if (typeInView.includes(combineInCondition)) match = true\n                })\n            })\n        }\n        return match;\n    }\n\n\n    let match = specMatch(condition.specification, view.specification)\n    if (!match) return [false, {\n        vis: 0,\n        task: 0,\n        data: 0,\n        sum: 0,\n    }]\n\n    match = typeMatchCombine(condition.actions, \n        condition.targets, \n        view.actionTargets);\n    if (!match) return [false, {\n        vis: 0,\n        task: 0,\n        data: 0,\n        sum: 0,\n    }]\n\n    match = typeMatch(condition.compositions, view.compositions);\n    if (!match) return [false, {\n        vis: 0,\n        task: 0,\n        data: 0,\n        sum: 0,\n    }]\n\n    match = typeMatchAll(condition.marks, view.marks);\n    if (!match) return [false, {\n        vis: 0,\n        task: 0,\n        data: 0,\n        sum: 0,\n    }]\n\n    match = typeMatch(condition.channels, view.channels);\n    if (!match) return [false, {\n        vis: 0,\n        task: 0,\n        data: 0,\n        sum: 0,\n    }]\n\n    match = typeMatchAll(condition.datas, view.dataTypes);\n    if (!match) return [false, {\n        vis: 0,\n        task: 0,\n        data: 0,\n        sum: 0,\n    }]\n\n    match = typeMatch(condition.aggregates, view.aggregates);\n    if (!match) return [false, {\n        vis: 0,\n        task: 0,\n        data: 0,\n        sum: 0,\n    }]\n\n\n\n    // const visMatchNum = typeMatchNum(condition.visType, view.figVis);\n    // if (visMatchNum > 0) found = true\n\n    return [true, {\n        vis: 0,\n        task: 0,\n        data: 0,\n        sum: 0,\n    }]\n}\n\n\n\n\nconst queryViews = condition => new Promise(resolve => {\n    ensureLoading(() => {\n        const views = data.current;\n\n        console.log(data.current);\n\n        const recommendations = [];\n\n        views.forEach(view => {\n            const [isMatch, rankScore] = viewMatchCondition(view, condition);\n            if (isMatch)\n                recommendations.push({\n                    viewId: view.viewId,\n                    rankScore,\n                })\n        })\n\n        resolve(recommendations);\n    });\n})\n\nconst queryViewById = viewId => new Promise(resolve => {\n    ensureLoading(() => {\n        const views = data.current;\n\n        for (const view of views)\n            if (view.viewId === viewId)\n                resolve({\n                    viewId,\n                    figFile: `https://github.com/KB4VA/data/blob/main/figures/systems/${view.figFile}?raw=true`,\n                    viewFile: `https://github.com/KB4VA/data/blob/main/figures/views/${view.viewFile}?raw=true`,\n                    specification: view.specification,\n                    actionTargets: view.actionTargets,\n                    compositions: view.compositions,\n                    marks: view.marks,\n                    channels: view.channels,\n                    dataTypes: view.dataTypes,\n                    aggregates: view.aggregates,\n                    figBox: view.figBox,\n                    figCaption: view.figCaption,\n                    figId: view.figId,\n                    relationText: view.relationText,\n                    note: view.note,\n                });\n    });\n});\n\nexport { queryViews, queryViewById };\n","import {queryViews} from \"../database/views\";\n\nexport default function queryRecommendations(condition) {\n    return new Promise(resolve => {\n        // if we have a backend, replace this with fetch API and move the database into the backend\n        queryViews(condition)\n          .then(res => resolve(res));\n    })\n}\n","export default function generateDataStructureFromFields(selectedFields, allFields) {\n    const types = {};\n\n    const addType = t => {\n        if (!types[t]) types[t] = 0;\n        types[t]++;\n    }\n\n    allFields.forEach(field => {\n        if (selectedFields.includes(field.name))\n            addType(field.type);\n    });\n\n    return Object.keys(types).map(t => `${t}×${types[t]}`).join(\" \");\n}\n","import loadDatabase from \"./loadDatabase\";\nimport packageJson from \"../../package.json\";\n\nconst {data, ensureLoading} = loadDatabase(`${packageJson.homepage}/figKnowledgeBase.json`);\n// const {data, ensureLoading} = loadDatabase(`${process.env.PUBLIC_URL}/figKnowledgeBase.json`);\n\nconst queryFigureById = figId => new Promise(resolve => {\n    ensureLoading(() => {\n        const figs = data.current;\n\n        for (const fig of figs)\n            if (fig.figId === figId)\n                resolve({\n                    figId,\n                    title: fig.title,\n                    caption: fig.caption,\n                    viewIds: fig.viewIds,\n                });\n    });\n});\n\nexport {queryFigureById};\n","import { makeAutoObservable } from \"mobx\";\nimport Papa from \"papaparse\";\nimport inferColumnTypeFromData from \"../utils/inferColumnTypeFromData\";\nimport queryRecommendations from \"../utils/queryRecommendations\";\nimport generateDataStructureFromFields from \"../utils/generateDataStructureFromFields\";\nimport { queryViewById } from \"../database/views\";\nimport { queryFigureById } from \"../database/figures\";\nimport { saveAs } from 'file-saver';\n\nclass Store {\n    constructor() {\n        makeAutoObservable(this);\n        window.onbeforeunload = (e) => {\n            e.preventDefault();\n            console.error(e);\n        }\n        window.onunload = e => {\n            e.preventDefault();\n            console.error(e);\n        }\n        this.generateRecommendationsFromQueryParams();\n    }\n\n    waiting = false;\n    startWait = () => this.waiting = true;\n    endWait = () => this.waiting = false;\n\n    data = [];\n    uploadData = () => {\n        const input = document.createElement(\"input\");\n        input.type = \"file\";\n        input.accept = \".csv\";\n        input.multiple = true;\n        input.onchange = () => {\n            const handleData = file => new Promise(resolve => {\n                Papa.parse(file, {\n                    header: true,\n                    complete: res => {\n                        res.errors.forEach(err => {\n                            if (err.code === \"TooFewFields\" && err.row === res.data.length - 1) // the last line is empty\n                                res.data.pop();\n                        });\n                        resolve({\n                            fileName: file.name,\n                            fields: res.meta.fields.map(f => ({\n                                type: inferColumnTypeFromData(res.data.map(d => d[f]), f),\n                                name: f,\n                            })),\n                            content: res.data,\n                        });\n                    }\n                })\n            });\n            const files = input.files;\n            const fileHandlers = [...new Array(files.length)].map((_, fId) => handleData(files[fId]));\n\n            Promise.all(fileHandlers)\n                .then(res => {\n                    this.resetQueryParams();\n                    this.setData(res);\n\n                    const fields = [];\n                    const fieldNames = [];\n                    res.map(res => res.fields)\n                        .flat()\n                        .forEach(field => {\n                            if (fieldNames.includes(field.name)) return;\n                            fields.push(field);\n                            fieldNames.push(field.name);\n                        })\n                    this.setFields(fields);\n                })\n        }\n        input.click();\n    }\n    setData = newData => this.data = newData;\n\n    fields = [];\n    setFields = newFields => this.fields = newFields;\n    setFieldType = (field, type) => this.fields.forEach(f => (f.name === field) && (f.type = type));\n\n    isTableViewerOpen = false;\n    showTableViewer = () => this.isTableViewerOpen = true;\n    closeTableViewer = () => this.isTableViewerOpen = false;\n\n    isReadMeOpen = true\n    handleReadMeOpen = () => this.isReadMeOpen = true;\n    handleReadMeClose = () => this.isReadMeOpen = false;\n\n\n    \n    vegaSpecInter = JSON.stringify({\n        \"x\": {\n            \"type\":\"*\"\n        },\n        \"y\": {\n            \"type\":\"*\"\n        }\n    }, null, 4);\n    // vegaSpecInter = JSON.stringify({facet: {},spec:{\n    //     \"mark\": \"bar\",\n    //     \"encoding\": {\n    //         \"x\": \"*\"\n    //     }\n    // }}, null, 4);\n\n    setSpecInter = (newValue) => {\n        this.vegaSpecInter = newValue\n    }\n\n    queryParams = {\n        fields: [],\n        isNonStructural: true,\n        dataStructure: \"\",\n        actions: [],\n        targets: [],\n        compositions: [],\n        marks: [],\n        channels: [],\n        dataTypes: [],\n        aggregates: [],\n        useSpec: false,\n        specification: {}\n\n    }\n    setQueryParams = newParams => {\n        this.queryParams = { ...this.queryParams, ...newParams };\n        if (this.queryParams.isNonStructural)\n            this.queryParams.dataStructure = generateDataStructureFromFields(\n                this.queryParams.fields,\n                this.fields,\n            )\n    }\n    resetQueryParams = () => {\n        this.setQueryParams({\n            fields: [],\n            isNonStructural: true,\n            dataStructure: \"\",\n            actions: [],\n            targets: [],\n            compositions: [],\n            marks: [],\n            channels: [],\n            dataTypes: [],\n            aggregates: [],\n            useSpec: false,\n            specification: {}\n        })\n        this.vegaSpecInter = JSON.stringify({\n            \"x\": {\n                \"type\":\"*\"\n            },\n            \"y\": {\n                \"type\":\"*\"\n            }\n        }, null, 4);\n        this.generateRecommendationsFromQueryParams();\n    }\n\n    views = {};\n    getViewData = viewId => new Promise(resolve => {\n        if (this.views[viewId]) {\n            resolve(this.views[viewId]);\n            return;\n        }\n\n        queryViewById(viewId)\n            .then(res => {\n                this.views[viewId] = res;\n                resolve(res);\n            })\n    })\n\n    recommendations = [];\n    setRecommendations = newRecommendations => this.recommendations = newRecommendations;\n    generateRecommendationsFromQueryParams = () => {\n        this.startWait();\n        const condition = {\n            \"actions\": this.queryParams.actions,\n            \"targets\": this.queryParams.targets,\n            \"compositions\": this.queryParams.compositions,\n            \"marks\": this.queryParams.marks,\n            \"channels\": this.queryParams.channels,\n            \"datas\": this.queryParams.dataTypes,\n            \"aggregates\": this.queryParams.aggregates\n        };\n        if (this.queryParams.useSpec) {\n            try {\n                condition.specification = JSON.parse(this.vegaSpecInter);\n            } catch (e) {\n                condition.specification = this.queryParams.specification\n            }\n        }\n        else{\n            condition.specification = this.queryParams.specification\n        }\n        // console.log(condition)\n        queryRecommendations(condition).then(res => {\n            this.endWait();\n            // console.log(res)\n            // res.sort((a, b) => b.rankScore.sum - a.rankScore.sum);\n            this.setRecommendations(res.map(d => ({ ...d, condition })));\n        })\n    }\n\n    viewDetail = null;\n    showViewDetail = (figId, initViewId) => this.viewDetail = { figId, initViewId };\n    closeViewDetail = () => this.viewDetail = null;\n\n    selectedViews = [];\n    selectView = viewId => {\n        this.getViewData(viewId)\n            .then(view => {\n                let condition = this.recommendations.find(rec => rec.viewId === viewId).condition;\n                this.selectedViews.push({\n                    viewId,\n                    figId: view.figId,\n                    viewFile: view.viewFile,\n                    // layout: JSON.parse(JSON.stringify(view.figBox)),\n                    condition,\n                });\n            })\n    }\n    setViews = newViews => this.selectedViews = newViews;\n    removeView = viewId => this.selectedViews = this.selectedViews.filter(v => v.viewId !== viewId);\n    // changePos = (viewId, newPos) => {\n    //     console.log(viewId, newPos);\n    //     this.selectedViews.forEach(v => {\n    //         if (v.viewId !== viewId) return;\n    //         v.layout = {...v.layout, ...newPos};\n    //     })\n    // };\n    // exportLayout = () => {\n    //     Promise.all(this.selectedViews.map(v => this.getViewData(v.viewId)))\n    //       .then(views => {\n    //           const text = JSON.stringify(this.selectedViews.map((v, vId) => {\n    //               return {\n    //                   view: views[vId].viewFile,\n    //                   layout: v.layout,\n    //               }\n    //           }));\n    //           const blob = new Blob([text], {type: \"text/plain;charset=utf-8\"});\n    //           saveAs(blob, \"layout.json\");\n    //       });\n    // }\n    importViews = () => {\n        const input = document.createElement(\"input\");\n        input.type = \"file\";\n        input.accept = \".json\";\n        input.onchange = () => {\n            const file = input.files[0];\n            if (!file) return;\n\n            const fr = new FileReader();\n            fr.onload = e => {\n                const res = JSON.parse(e.target.result);\n                Promise.all(res.map(importView => new Promise(resolve => {\n                    this.getViewData(importView.view)\n                        .then(view => {\n                            resolve({\n                                viewId: importView.view,\n                                figId: view.figId,\n                                viewFile: view.viewFile,\n                                condition: importView.condition,\n                            })\n                        })\n                })))\n                    .then(viewList => this.setViews(viewList))\n            }\n            fr.readAsText(file, \"utf-8\");\n        }\n        input.click();\n    }\n    exportViews = () => {\n        Promise.all(this.selectedViews.map(v => this.getViewData(v.viewId)))\n            .then(views => {\n                const text = JSON.stringify(this.selectedViews.map((v, vId) => {\n                    return {\n                        view: views[vId].viewId,\n                        // layout: v.layout,\n                        condition: v.condition,\n                    }\n                }));\n                const blob = new Blob([text], { type: \"text/plain;charset=utf-8\" });\n                saveAs(blob, \"views.json\");\n            });\n    }\n\n    figures = {};\n    getFigureData = figId => new Promise(resolve => {\n        if (this.figures[figId]) {\n            resolve(this.figures[figId]);\n            return;\n        }\n\n        queryFigureById(figId)\n            .then(res => {\n                this.figures[figId] = res;\n                resolve(res);\n            })\n    });\n}\n\nconst store = new Store();\nexport default store;\n","import {useEffect, useState} from \"react\";\nimport store from \"../../store\";\n\nexport default function useView(viewId) {\n    const [view, setView] = useState({\n        viewId,\n        figFile: \"\",\n        viewFile: \"\",\n        specification: \"\",\n        actionTargets:[],\n        compositions: [],\n        marks: [],\n        channels: [],\n        dataTypes:[],\n        aggregates: [],\n        figBox: {x: 0, y: 0, width: 0, height: 0},\n        figCaption: \"\",\n        figId: \"\",\n    });\n\n    useEffect(() => {\n        if (!viewId) return;\n        store.getViewData(viewId)\n          .then(res => {\n              setView(res);\n          });\n    }, [viewId]);\n\n    return view;\n}\n","import React from 'react';\nimport {alpha, makeStyles, Paper} from \"@material-ui/core\";\nimport Image from \"./Image\";\nimport useView from \"../hooks/useView\";\n\nconst useStyles = makeStyles(theme => ({\n    figImage: {\n        height: '100%',\n        // width: 'fit-content',\n        maxWidth: '100%',\n        position: 'relative',\n    },\n    figFile: {\n        height: '100%',\n        width: '100%',\n    },\n    box: {\n        position: 'absolute',\n        backgroundColor: alpha(theme.palette.primary.main, 0.8),\n    }\n}));\n\nfunction FigImage({viewId, onLoad, type = \"fill\", ...props}) {\n    const classes = useStyles();\n\n    const view = useView(viewId);\n\n    const pos = (() => {\n        const {x, y, width, height} = view.figBox;\n        return {\n            left: `${x * 100}%`,\n            top: `${y * 100}%`,\n            width: `${width * 100}%`,\n            height: `${height * 100}%`,\n        };\n    })();\n\n    return <Paper className={classes.figImage} elevation={4}>\n        <Image src={view.figFile} alt={view.figFile}\n                // view={view}\n                // viewId={viewId}\n                // verbose = {props.verbose}\n               className={classes.figFile}\n               onLoad={onLoad}\n               type={type}\n               overlay={<div className={classes.box} style={pos}/>}\n               {...props}/>\n    </Paper>\n}\n\nexport default FigImage;\n","import React from 'react';\nimport { Dialog, DialogContent, makeStyles, Typography} from \"@material-ui/core\";\nimport { useTheme } from '@material-ui/styles';\nimport { inject, observer } from \"mobx-react\";\nimport Editor from \"@monaco-editor/react\";\nimport FigImage from \"../../components/FigImage\";\nimport Image from \"../../components/Image\";\nimport useFigure from \"../../hooks/useFigure\";\nimport useView from \"../../hooks/useView\";\nimport clsx from \"clsx\";\n\nconst useStyles = makeStyles(theme => ({\n    figureViewer: {\n        padding: 0,\n        height: 800,\n        maxHeight: '80vh',\n        backgroundColor: theme.palette.primary.light,\n        overflow: 'hidden',\n        '&:first-child': {\n            paddingTop: 0,\n        }\n    },\n    top: {\n        height: `calc(100% - ${200 + theme.spacing(3)}px)`,\n        display: 'flex',\n        margin: theme.spacing(1, 2),\n        overflow: \"hidden\",\n    },\n    bigImage: {\n        width: `calc(100% - ${500 + theme.spacing(3)}px)`,\n        flex: `1 1 0`,\n        overflow: 'hidden',\n        padding: theme.spacing(1, 1, 1, 1),\n    },\n    viewImage: {\n    },\n    imageLimitation: {\n        width: props => props.width,\n        height: props => props.height,\n    },\n    spec: {\n        height: `calc(100% - ${theme.spacing(1)}px)`,\n        width: 300,\n        flex: `0 0 500px`,\n        padding: theme.spacing(2, 1, 1, 1),\n        overflow: \"hidden\",\n    },\n    info: {\n        height: `calc(100% - ${theme.spacing(1)}px)`,\n        width: 200,\n        flex: `0 0 350px`,\n        padding: theme.spacing(1, 1, 1, 1),\n        overflow: \"hidden auto\",\n    },\n    title: {\n        height: '30px'\n    },\n    text: {\n        '& + $title': {\n            marginTop: theme.spacing(1),\n        }\n    },\n    viewList: {\n        flex: '0 0 200px',\n        height: 200,\n        display: 'flex',\n        overflow: 'scroll hidden',\n        paddingBottom: theme.spacing(1),\n        margin: theme.spacing(0, 1)\n    },\n    view: {\n        flex: '0 0 auto',\n        margin: theme.spacing(0.5, 1),\n    },\n    selected: {\n        boxShadow: `0 0 2px 2px ${theme.palette.primary.dark}`,\n    }\n}));\n\nfunction FigureViewer({ store }) {\n    const classes = useStyles();\n    const theme = useTheme();\n\n    const { title, caption, viewIds, selected, select } = useFigure(store.viewDetail);\n    const view = useView(viewIds[selected]);\n    \n    const beautifyActionTarget = (actionTargets) =>{\n        let atArray = []\n        actionTargets.forEach((actionTarget) => {\n            const action = actionTarget.replace(\"produce\",\"produce-produce\").split(\":\")[0].split(\"-\")[1]\n            const target = actionTarget.split(\":\")[1].split(\"-\")[1]\n            atArray.push(`${action} ${target}`)\n        })\n        return atArray.join(\", \")\n    }\n\n    // console.log(viewIds[selected], selected)\n\n    return <Dialog open={store.viewDetail !== null}\n        onClose={store.closeViewDetail}\n        maxWidth={\"xl\"}\n        fullWidth>\n        <DialogContent className={classes.figureViewer}>\n            <div className={classes.top}>\n                <div className={classes.bigImage}>\n                    {/* <FigImage key={`bigimg-${viewIds[selected]}`} viewId={viewIds[selected]} type={\"center\"} /> */}\n                    <Image className={classes.viewImage} src={view.viewFile} alt={view.viewFile} type={\"center\"}/>\n                </div>\n                <div className={classes.spec}>\n                    <Typography className={classes.title} variant={\"subtitle1\"}>Specification</Typography>\n                    <Editor\n                        defaultLanguage=\"json\"\n                        options={{\n                            lineNumbers: false,\n                            readOnly: true,\n                            background: theme.palette.primary.light,\n                        }}\n                        value={JSON.stringify(view.specification, null, 4)}\n                        style={{height: '100%'}}\n                    />\n                </div>\n                <div className={classes.info}>\n\n                    <Typography className={classes.title} variant={\"subtitle1\"}>Title</Typography>\n                    <Typography className={classes.text}\n                        title={title}>{title}</Typography>\n\n                    <Typography className={classes.title} variant={\"subtitle1\"}>Action-Target Pairs</Typography>\n                    <Typography className={classes.text}\n                        title={view.actionTargets.join(\", \")}>{beautifyActionTarget(view.actionTargets)}</Typography>\n\n                    <Typography className={classes.title} variant={\"subtitle1\"}>Compositions</Typography>\n                    <Typography className={classes.text}\n                        title={view.compositions.join(\", \")}>{view.compositions.join(\", \")}</Typography>\n\n                    <Typography className={classes.title} variant={\"subtitle1\"}>Mark Types</Typography>\n                    <Typography className={classes.text}\n                        title={view.marks.join(\", \")}>{view.marks.join(\", \")}</Typography>\n\n\n                    <Typography className={classes.title} variant={\"subtitle1\"}>Data Types</Typography>\n                    <Typography className={classes.text}\n                        title={view.dataTypes.join(\", \")}>{view.dataTypes.join(\", \")}</Typography>\n                    <Typography className={classes.title} variant={\"subtitle1\"}>Channels</Typography>\n                    <Typography className={classes.text}\n                        title={view.channels.join(\", \")}>{view.channels.join(\", \")}</Typography>\n                    \n                    <Typography className={classes.title} variant={\"subtitle1\"}>Aggregates</Typography>\n                    <Typography className={classes.text}\n                        title={view.aggregates.join(\", \")}>{view.aggregates.join(\", \")}</Typography>\n\n                    <Typography className={classes.title} variant={\"subtitle1\"}>Caption</Typography>\n                    <Typography className={classes.text}\n                        title={caption}>{caption}</Typography>\n                </div>\n            </div>\n            <div className={classes.viewList}>\n                {viewIds.map((viewId, vId) => <div key={viewId}\n                    className={clsx(classes.view, {\n                        [classes.selected]: vId === selected,\n                    })}\n                    onClick={() => select(vId)}>\n                    <FigImage key={viewId} viewId={viewId} type={\"fullHeight\"} />\n                </div>)}\n            </div>\n        </DialogContent>\n    </Dialog>\n}\n\nexport default inject('store')(observer(FigureViewer));\n","import {useEffect, useState} from \"react\";\nimport store from \"../../store\";\n\nexport default function useFigure(props) {\n    const [selected, select] = useState(0);\n\n    const [figure, setFigure] = useState({\n        title: \"\",\n        caption: \"\",\n        viewIds: [],\n    });\n\n    useEffect(() => {\n        if (!props) return;\n        const {figId, initViewId} = props;\n        store.getFigureData(figId)\n          .then(res => {\n              setFigure(res);\n              res.viewIds.forEach((viewId, vId) => {\n                  if (viewId === initViewId) {\n                      select(vId);\n                  }\n              })\n          });\n    }, [props])\n\n    return {\n        ...figure,\n        selected,\n        select,\n    };\n}\n","import React from \"react\";\nimport {makeStyles, Typography} from \"@material-ui/core\";\nimport clsx from \"clsx\";\n\nconst useStyles = makeStyles(theme => ({\n    item: {\n        width: '100%',\n        display: \"flex\",\n        flexWrap: 'wrap',\n        margin: theme.spacing(0.5, 0),\n        justifyContent: 'space-between'\n    },\n    solid: {\n        flex: 0,\n    },\n    placeholder: {\n        flexBasis: 0,\n        flexGrow: 1,\n        flexDirection: 'column',\n    },\n    shrinkable: {\n        flexBasis: 'auto',\n        flexShrink: 1,\n        minHeight: 24,\n        overflow: \"hidden auto\",\n    },\n    action: {\n        justifyContent: 'center',\n        flexWrap: 'nowrap',\n    }\n}))\n\nfunction Item({\n                  children,\n                  solid = true,\n                  placeholder = false,\n                  shrinkable = false,\n                  action = false,\n                  title = null,\n              }) {\n    const classes = useStyles();\n\n    return <div className={clsx(\n      classes.item,\n      {\n          [classes.solid]: solid,\n          [classes.placeholder]: placeholder,\n          [classes.shrinkable]: shrinkable,\n          [classes.action]: action,\n      }\n    )}>\n        {title && <Typography variant={\"subtitle1\"}>{title}</Typography>}\n        {children}\n    </div>\n}\n\nexport default Item;\n","import React from 'react';\nimport {Grid, Switch, Typography} from \"@material-ui/core\";\n\nfunction DualSwitch({left, right, ...props}) {\n    return <Typography component=\"div\" noWrap>\n        <Grid component=\"label\" container alignItems=\"center\" spacing={1}>\n            <Grid item>{left}</Grid>\n            <Grid item>\n                <Switch color={\"primary\"} {...props}/>\n            </Grid>\n            <Grid item>{right}</Grid>\n        </Grid>\n    </Typography>\n}\n\nexport default React.memo(DualSwitch);\n","import {alpha, darken, lighten} from \"@material-ui/core\";\nconst primaryColor = \"rgb(20, 90, 140)\";\nconst scrollColor = \"rgb(36, 40, 41)\";\nconst theme = {\n    palette: {\n        primary: {\n            light: 'rgb(239, 250, 254)',\n            main: 'rgb(212, 231, 245)',\n            dark: primaryColor,\n        },\n        background: {\n            default: 'rgb(239, 250, 254)',\n        }\n    },\n    props: {\n        MuiAppBar: {\n            elevation: 1,\n        }\n    },\n    overrides: {\n        MuiAppBar: {\n            colorPrimary: {\n                backgroundColor: primaryColor,\n                color: '#ffffff',\n            },\n        },\n        MuiTypography: {\n            subtitle1: {\n                fontWeight: 'bold'\n            }\n        },\n        MuiCheckbox: {\n            colorPrimary: {\n                color: alpha(primaryColor, 0.5),\n                \"&$checked\": {\n                    color: primaryColor,\n                }\n            }\n        },\n        MuiSwitch: {\n            colorPrimary: {\n                \"&$checked\": {\n                    color: primaryColor,\n                }\n            }\n        },\n        MuiTooltip: {\n            tooltip: {\n                maxWidth: 500,\n                fontSize: '1.25rem',\n                whiteSpace: 'pre-line',\n            }\n        },\n        MuiCssBaseline: {\n            '@global': {\n                '*::-webkit-scrollbar': {\n                    width: 10,\n                    height: 10,\n                },\n                '*::-webkit-scrollbar-track': {\n                    display: 'none',\n                },\n                '*::-webkit-scrollbar-corner': {\n                    display: 'none',\n                },\n                '*::-webkit-scrollbar-thumb': {\n                    backgroundColor: alpha(scrollColor, 0.1),\n                    borderRadius: 10,\n                },\n                '*:hover::-webkit-scrollbar-thumb': {\n                    backgroundColor: lighten(scrollColor, 0.2),\n                },\n                '*::-webkit-scrollbar-thumb:hover': {\n                    backgroundColor: scrollColor,\n                },\n                '*::-webkit-scrollbar-thumb:active': {\n                    backgroundColor: darken(scrollColor, 0.2),\n                }\n            }\n        }\n    },\n    spacing: 10,\n}\n\nexport default theme;\n","import snake2word from \"../utils/snake2word\";\n\nconst constValues = {\n    actions: {\n        consume: [\n            { value: \"consume-present\", label: \"present\" },\n            { value: \"consume-discover\", label: \"discover\" },\n            { value: \"consume-enjoy\", label: \"enjoy\" },\n        ],\n        produce: [\n            { value: \"produce\", label: \"produce\" }\n        ],\n        search: [\n            { value: \"search-lookup\", label: \"lookup\" },\n            { value: \"search-browse\", label: \"browse\" },\n            { value: \"search-locate\", label: \"locate\" },\n            { value: \"search-explore\", label: \"explore\" },\n        ],\n        query: [\n            { value: \"query-identify\", label: \"identify\" },\n            { value: \"query-compare\", label: \"compare\" },\n            { value: \"query-summarize\", label: \"summarize\" }\n        ],\n    },\n    targets: {\n        Attributes: [\n            { value: \"Attributes-values\", label: \"values\" },\n            { value: \"Attributes-distribution\", label: \"distribution\" },\n            { value: \"Attributes-range\", label: \"range\" },\n            { value: \"Attributes-extremes\", label: \"extremes\" },\n            { value: \"Attributes-outliers\", label: \"anomalies\" },\n            { value: \"Attributes-clusters\", label: \"clusters\" },\n            { value: \"Attributes-order\", label: \"order\" },\n            { value: \"Attributes-correlation\", label: \"correlation\" },\n            { value: \"Attributes-similarity\", label: \"similarity\" }],\n        Graphs: [\n            { value: \"Graphs-graphs\", label: \"graphs\" },\n            { value: \"Graphs-nodes\", label: \"nodes\" },\n            { value: \"Graphs-links/paths\", label: \"links/paths\" },\n            { value: \"Graphs-topology/structures\", label: \"topology/structures\" },\n            { value: \"Graphs-clusters/groups\", label: \"clusters/groups\" }]\n    },\n    aggregates: [\n        { value: \"count\", label: \"count\" },\n        { value: \"bin\", label: \"bin\" },\n        { value: \"average\", label: \"average\" },\n        { value: \"sum\", label: \"sum\" },\n        { value: \"median\", label: \"median\" },\n        { value: \"variance\", label: \"variance\" },\n    ],\n    marks: [\n        { value: \"bar\", label: \"bar\" },\n        { value: \"point\", label: \"scatter plot\" },\n        { value: \"line\", label: \"line\" },\n        { value: \"rect\", label: \"rect\" },\n        { value: \"area\", label: \"area\" },\n        { value: \"unit\", label: \"unit\" },\n        { value: \"arc\", label: \"pie/donut\" },\n        { value: \"sankey\", label: \"sankey\" },\n        { value: \"geoshape\", label: \"map\" },\n        { value: \"radar\", label: \"radar\" },\n        { value: \"tree\", label: \"tree\" },\n        { value: \"boxplot\", label: \"boxplot\" },\n        { value: \"tick\", label: \"tick\" },\n        { value: \"surface\", label: \"surface\" },\n        { value: \"text\", label: \"text\" },\n        { value: \"treemap\", label: \"treemap\" },\n        { value: \"word_cloud\", label: \"word cloud\" },\n        { value: \"circle\", label: \"circle\" },\n        { value: \"rule\", label: \"rule\" },\n        { value: \"image\", label: \"image\" },\n        { value: \"dandelion\", label: \"dandelion\" },\n        { value: \"icicle\", label: \"icicle\" },\n        { value: \"icon\", label: \"icon\" },\n        { value: \"storyline\", label: \"storyline\" },\n        { value: \"sunburst\", label: \"sunburst\" },\n        { value: \"venn\", label: \"venn\" },\n        { value: \"calendar\", label: \"calendar\" },\n        { value: \"contour\", label: \"contour\" },\n        { value: \"graph\", label: \"graph\" },\n        { value: \"matrix\", label: \"matrix\" },\n        { value: \"vector\", label: \"vector\" },\n        { value: \"others\", label: \"others\" },],\n    dataTypes: [\n        { value: \"quantitative\", label: \"quantitative\" },\n        { value: \"nominal\", label: \"nominal\" },\n        // { value: \"node\", label: \"node\" },\n        { value: \"temporal\", label: \"temporal\" },\n        // { value: \"relation\", label: \"relation\" },\n        { value: \"ordinal\", label: \"ordinal\" }],\n    compositions: [\n        { value: \"nested\", label: \"nested\" },\n        { value: \"layer\", label: \"layer\" },\n        { value: \"facet\", label: \"facet\" },\n        { value: \"concat\", label: \"concat\" },\n    ],\n    channels: [\n        { value: \"x\", label: \"x\" },\n        { value: \"y\", label: \"y\" },\n        { value: \"color\", label: \"color\" },\n        { value: \"node\", label: \"node\" },\n        { value: \"link\", label: \"link\" },\n        { value: \"theta\", label: \"theta\" },\n        { value: \"size\", label: \"size\" },\n        { value: \"radius\", label: \"radius\" },\n        { value: \"unit\", label: \"unit\" },\n        { value: \"text\", label: \"text\" },\n        { value: \"xoffset\", label: \"xoffset\" }]\n}\n\nexport default constValues;\n","import strings from \"./strings\"\nimport theme from \"./theme\";\nimport constValues from \"./const\";\nimport colors from \"./colors\";\n\nconst R = {\n    strings,\n    theme,\n    const: constValues,\n    colors,\n}\n\nexport default R;\n","const strings = {\n    systemName: \"KB4VA Explorer\",\n}\n\nexport default strings;\n","const colors = {\n    'tree': '#e8c7c7',\n    'graph': '#d8a3a3',\n    'treemap': '#c87e7e',\n    'hierarchical_edge_bundling': '#b85a5a',\n    'sunburst_icicle': '#a93636',\n    'line_chart': '#d8bea3',\n    'parallel_coordinate': '#c8a47e',\n    'polar_plot': '#b88a5a',\n    'storyline': '#a97036',\n    'flow_diagram': '#c8c87e',\n    'chord_diagram': '#b8b85a',\n    'sankey_diagram': '#a9a936',\n    'map': '#70a936',\n    'heatmap': '#7ec87e',\n    'unit_visualization': '#5ab85a',\n    'glyph_based': '#36a936',\n    'scatterplot': '#36a970',\n    'matrix': '#7ec8c8',\n    'table': '#5ab8b8',\n    'small_multiple': '#36a9a9',\n    'pie_chart': '#7ea4c8',\n    'sector_chart': '#5a8ab8',\n    'donut_chart': '#3670a9',\n    'error_bar': '#7e7ec8',\n    'box_plot': '#5a5ab8',\n    'stripe_graph': '#3636a9',\n    'bar_chart': '#7036a9',\n    'area_chart': '#b85ab8',\n    'proportional_area_chart': '#a936a9',\n    'word_cloud': '#a93670',\n    \"contour_graph\": '#d8bea3',\n    \"surface_graph\": '#b88a5a',\n    \"vector_graph\": '#a97036',\n    'scivis': '#c8c87e',\n    'others': '#d3d3d3'\n}\nexport default colors;\n","import React from 'react';\nimport {Checkbox, ListItemText, ListSubheader, MenuItem, TextField, Typography} from \"@material-ui/core\";\n\nfunction ItemSelect({title, value, onChange, options, twolevel=false}) {\n    const val2label = val => {\n        if (twolevel){\n            let label = null\n            Object.keys(options).forEach((key) => {\n                if (label === null){\n                    const idx = options[key].findIndex(option => option.value === val);\n                    if (idx != -1) label = options[key][idx].label;\n                }\n            })\n            if (label == null) return val; else return label\n        }\n        else{\n            const idx = options.findIndex(option => option.value === val);\n            if (idx === -1) return val;\n            return options[idx].label;\n        }\n    }\n    const wrapper = React.createRef();\n\n    return <div ref={wrapper} style={{padding: '0px 15px 0px 10px'}}>\n        {title && <Typography variant={\"subtitle1\"}>{title}</Typography>}\n        <TextField select\n                        SelectProps={{\n                            multiple: true,\n                            renderValue: selected => selected.map(val => val2label(val)).join(', '),\n                        }}\n                        style={{width: 200}}\n                        value={value}\n                        onChange={onChange}>\n            {!twolevel && options.map((option) => (\n            <MenuItem key={option.value} value={option.value}>\n                <Checkbox checked={value.includes(option.value)}/>\n                <ListItemText primary={option.label}/>\n            </MenuItem>\n            ))}\n            {twolevel && Object.keys(options).map((l1) => (\n                    [<ListSubheader >{l1}</ListSubheader>,\n                    options[l1].map((option) =>(\n                        <MenuItem key={`${option.value}`} value={`${option.value}`}>\n                            <Checkbox checked={value.includes(option.value)}/>\n                            <ListItemText primary={option.label}/>\n                        </MenuItem>))]\n            ))}\n        </TextField>\n    </div>\n}\n\nexport default React.memo(ItemSelect);\n","import React, {useState} from 'react';\nimport {Button, Checkbox, Input, makeStyles, MenuItem, Select, Typography} from \"@material-ui/core\";\nimport {inject, observer} from \"mobx-react\";\nimport R from \"../../../res\";\n\nconst useStyles = makeStyles(theme => ({\n    fieldCheckbox: {\n        display: 'flex',\n        width: '100%',\n        alignItems: 'center',\n    },\n    text: {\n        display: 'flex',\n        flex: 1,\n        overflow: 'hidden',\n        border: `1px solid ${theme.palette.primary.main}`,\n        borderRadius: theme.shape.borderRadius,\n    },\n    type: {\n        margin: theme.spacing(0, 1),\n        minWidth: 0,\n        padding: theme.spacing(0, 1),\n        flex: 0,\n    },\n    name: {},\n    selectInput: {\n        display: 'none',\n    }\n}));\n\nfunction FieldCheckbox({\n                           type,\n                           name,\n                           editable,\n                           checked,\n                           onChange,\n                           onChangeType,\n                       }) {\n    const classes = useStyles();\n\n    const [open, setOpen] = useState(false);\n    const handleOpen = () => setOpen(true);\n    const handleClose = () => setOpen(false);\n\n    const handleChange = e => onChangeType(name, e.target.value);\n\n    return <div className={classes.fieldCheckbox}>\n        <div className={classes.text}>\n            <Button className={classes.type} variant={\"text\"} size={\"small\"}\n                    onClick={handleOpen}>\n                {type}\n            </Button>\n            <Typography className={classes.name} noWrap>#{name}</Typography>\n        </div>\n        <Checkbox color=\"primary\"\n                  disabled={!editable}\n                  checked={checked && editable}\n                  onChange={onChange}/>\n        <Select open={open}\n                onClose={handleClose}\n                onOpen={handleOpen}\n                value={type}\n                input={<Input className={classes.selectInput}/>}\n                onChange={handleChange}>\n            {R.const.fieldTypes.map(fT => <MenuItem key={fT.value} value={fT.value}>{fT.label}</MenuItem>)}\n        </Select>\n    </div>\n}\n\nexport default inject()(observer(FieldCheckbox));\n","import React from \"react\";\r\nimport {Switch, FormControlLabel } from '@material-ui/core';\r\nimport {inject, observer} from \"mobx-react\";\r\nimport Editor from \"@monaco-editor/react\";\r\n\r\nfunction SpecInput({store}) {\r\n\r\n  const inputChange = (newValue, event) => {\r\n    store.setSpecInter(newValue)\r\n    // store.setQueryParams({vegaSpec: e.target.value})\r\n  }\r\n\r\n  const options = {\r\n    selectOnLineNumbers: true,\r\n    // readOnly: true\r\n  };\r\n\r\n  return (\r\n    <div style={{display: 'block', width: '100%'}}>\r\n      <FormControlLabel\r\n          control={<Switch \r\n            checked={store.queryParams.useSpec}\r\n            onChange={(e) => store.setQueryParams({useSpec: e.target.checked})}\r\n            color=\"primary\" \r\n            name=\"search by specification\" />}\r\n          label=\"Use Specification\"\r\n          style={{padding: \"10px\"}}\r\n        />\r\n    <Editor\r\n      height=\"30vh\"\r\n      defaultLanguage=\"json\"\r\n      options={options}\r\n      onChange={inputChange}\r\n      value={store.vegaSpecInter}\r\n      defaultValue={JSON.stringify({\r\n        \"x\": {\r\n            \"type\":\"*\"\r\n        },\r\n        \"y\": {\r\n            \"type\":\"*\"\r\n        }\r\n    }, null, 4)}\r\n    />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default inject(\"store\")(observer(SpecInput));\r\n","import React from 'react';\nimport {Button, makeStyles, TextField, Tooltip, Typography} from \"@material-ui/core\";\nimport {inject, observer} from \"mobx-react\";\nimport QueryItem from \"./QueryItem\";\nimport {Refresh} from \"@material-ui/icons\";\nimport DualSwitch from \"./DualSwitch\";\nimport R from \"../../../res\";\nimport ItemSelect from \"./ItemSelect\";\nimport FieldCheckbox from \"./FieldCheckbox\";\nimport SpecInput from \"./SpecInput\"\n\nconst useStyles = makeStyles(theme => ({\n    queryPanel: {\n        width: '100%',\n        height: '100%',\n        overflow: 'hidden',\n        display: 'flex',\n        flexDirection: 'column',\n    },\n    itemContainer:{\n        height: '30vh',\n        width: '100%',\n        display: 'flex',\n        flexWrap: 'wrap',\n        justifyContent: 'start'\n    }\n}));\n\nfunction QueryPanel({store}) {\n    const classes = useStyles();\n\n    return <div className={classes.queryPanel}>\n        <QueryItem title={\"Filters\"}>\n            <div className={classes.itemContainer}>\n                <ItemSelect title={\"Task: Action\"}\n                            value={store.queryParams.actions}\n                            onChange={e => store.setQueryParams({actions: e.target.value})}\n                            options={R.const.actions}\n                            twolevel/>\n                <ItemSelect title={\"Task: Target\"}\n                            value={store.queryParams.targets}\n                            onChange={e => store.setQueryParams({targets: e.target.value})}\n                            options={R.const.targets}\n                            twolevel/>\n                <ItemSelect title={\"Layout\"}\n                            value={store.queryParams.compositions}\n                            onChange={e => store.setQueryParams({compositions: e.target.value})}\n                            options={R.const.compositions}/>\n                <ItemSelect title={\"Visualization\"}\n                            value={store.queryParams.marks}\n                            onChange={e => store.setQueryParams({marks: e.target.value})}\n                            options={R.const.marks.sort((a, b) => (a.label > b.label) ? 1 : -1)}/>\n                <ItemSelect title={\"Visual Channel\"}\n                            value={store.queryParams.channels}\n                            onChange={e => store.setQueryParams({channels: e.target.value})}\n                            options={R.const.channels}/>\n                <ItemSelect title={\"Data Type\"}\n                            value={store.queryParams.dataTypes}\n                            onChange={e => store.setQueryParams({dataTypes: e.target.value})}\n                            options={R.const.dataTypes}/>\n                {/* <ItemSelect title={\"Aggregate\"}\n                            value={store.queryParams.aggregates}\n                            onChange={e => store.setQueryParams({aggregates: e.target.value})}\n                            options={R.const.aggregates}/> */}\n            </div>\n        </QueryItem>\n        \n        <QueryItem title={\"JSON Specification\"}>\n            <SpecInput />\n        </QueryItem>\n\n        <QueryItem placeholder/>\n        <QueryItem action>\n            <Button variant={\"outlined\"} onClick={() => {\n                store.generateRecommendationsFromQueryParams();\n            }}>Search</Button>\n        </QueryItem>\n        <QueryItem action>\n            <Button variant={\"text\"} endIcon={<Refresh/>} onClick={store.resetQueryParams}>Reset</Button>\n        </QueryItem>\n    </div>\n}\n\nexport default inject(\"store\")(observer(QueryPanel));\n","import React from 'react';\nimport {IconButton, makeStyles} from \"@material-ui/core\";\nimport clsx from \"clsx\";\n\nconst useStyles = makeStyles(theme => ({\n    actionBox: {\n        position: 'relative',\n        \"&:hover > $actions\": {\n            opacity: 1,\n        }\n    },\n    actions: {\n        position: 'absolute',\n        right: 0,\n        top: 0,\n        maxWidth: '100%',\n        display: 'flex',\n        flexWrap: 'wrap',\n        opacity: 0,\n        transition: 'opacity .3s linear',\n    },\n    action: {\n        flex: 0,\n        margin: theme.spacing(0.5),\n    }\n}));\n\nfunction ActionBox({actions, className, children}) {\n    const classes = useStyles();\n\n    return <div className={clsx(classes.actionBox, className)}>\n        {children}\n        <div className={classes.actions}>\n            {actions.map((action, aId) => <div key={aId} className={classes.action}>\n                <IconButton size={\"small\"} onClick={action.click}>\n                    {action.icon}\n                </IconButton>\n            </div>)}\n        </div>\n    </div>\n}\n\nexport default ActionBox;\n","import React from 'react';\nimport {makeStyles, Paper, Popover, Tooltip, Typography} from \"@material-ui/core\";\nimport {inject, observer} from \"mobx-react\";\nimport ActionBox from \"../../components/ActionBox\";\nimport {InfoOutlined, Loupe, Star, StarHalf} from \"@material-ui/icons\";\nimport useView from \"../../hooks/useView\";\nimport Image from \"../../components/Image\";\n\nconst useStyles = makeStyles(theme => ({\n    recommendation: {\n        minWidth: 300,\n        width: '100%',\n        height: 200,\n        backgroundColor: theme.palette.background.default,\n        display: 'flex',\n        padding: theme.spacing(1, 0.5, 1, 1),\n    },\n    image: {\n        flex: '1 1 0',\n        width: 0,\n    },\n    imagePreview: {\n        maxHeight: '60vh',\n        maxWidth: '60vw',\n    },\n    popover: {\n        pointerEvents: 'none',\n    },\n    paper: {\n        padding: theme.spacing(1),\n        width: '30vw',\n        textAlign: \"center\",\n    },\n    popoverText: {\n        textAlign: 'left',\n    },\n    info: {\n        flex: '1 1 0',\n        width: 0,\n        margin: theme.spacing(1, 1, 1, 0.5),\n        overflow: 'hidden auto',\n    },\n    title: {\n        verticalAlign: 'Bottom',\n        display: 'inline-flex',\n    },\n    icon: {\n        fontSize: '1.25rem',\n        margin: `4px 2px`,\n    },\n    text: {\n        marginLeft: 24,\n        '& + $title': {\n            marginTop: theme.spacing(1),\n        }\n    },\n}));\n\n\nfunction Recommendation({rec, store}) {\n    const classes = useStyles();\n\n    const view = useView(rec.viewId);\n\n    const handleDragStart = (ev) => {\n        ev.dataTransfer.setData(\"viewId\", rec.viewId);\n        ev.dataTransfer.dropEffect = \"copy\";\n    };\n\n    const [anchorEl, setAnchorEl] = React.useState(null);\n\n    const handlePopoverOpen = (event) => {\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handlePopoverClose = () => {\n        setAnchorEl(null);\n    };\n\n    const open = Boolean(anchorEl);\n\n    return <ActionBox actions={[\n        {\n            icon: <Loupe/>, click: e => {\n                e.preventDefault();\n                store.showViewDetail(view.figId, view.viewId)\n            }\n        }\n    ]}>\n        <Paper elevation={4} className={classes.recommendation} draggable onDragStart={handleDragStart}>\n            <Image src={view.viewFile} alt={view.viewFile} className={classes.image}\n                   onMouseEnter={handlePopoverOpen}\n                   onMouseLeave={handlePopoverClose}/>\n            <Popover className={classes.popover}\n                     classes={{paper: classes.paper}}\n                     open={open}\n                     anchorEl={anchorEl}\n                     anchorOrigin={{\n                         vertical: 'bottom',\n                         horizontal: 'center',\n                     }}\n                     transformOrigin={{\n                         vertical: 'top',\n                         horizontal: 'center',\n                     }}\n                     onClose={handlePopoverClose}\n                     disableRestoreFocus>\n                <img className={classes.imagePreview} src={view.viewFile} alt={view.viewFile}/>\n            </Popover>\n        </Paper>\n    </ActionBox>\n}\n\nexport default inject('store')(observer(Recommendation));\n","import React, {useRef} from 'react';\nimport {makeStyles} from \"@material-ui/core\";\nimport {inject, observer} from \"mobx-react\";\nimport Recommendation from \"./Recommendation\";\nimport {useSize} from \"ahooks\";\n\nconst useStyles = makeStyles(theme => ({\n    recommendationsPanel: {\n        overflow: \"hidden scroll\",\n        width: '100%',\n        height: '100%',\n        paddingLeft: theme.spacing(0.5),\n        paddingRight: theme.spacing(1),\n        display: 'grid',\n        gridTemplateColumns: props => `repeat(${Math.floor((props.width - theme.spacing(2)) / (300 + theme.spacing(2)))}, 1fr)`,\n        gridTemplateRows: `repeat(auto-fill, 200px)`,\n        gap: theme.spacing(2),\n        justifyContent: \"space-evenly\",\n    },\n}));\n\nfunction RecommendationsPanel({store}) {\n    const cRef = useRef();\n    const {width} = useSize(cRef);\n\n    const classes = useStyles({width});\n\n    return <div className={classes.recommendationsPanel} ref={cRef}>\n        {store.recommendations.map(rec => <Recommendation key={rec.viewId}\n                                                          rec={rec}/>)}\n    </div>\n}\n\nexport default inject('store')(observer(RecommendationsPanel));\n","import React from 'react';\nimport {makeStyles, Typography} from \"@material-ui/core\";\nimport {inject, observer} from \"mobx-react\";\n\nconst useStyles = makeStyles(theme => ({\n    panel: {\n        position: 'absolute',\n        backgroundColor: theme.palette.background.paper,\n        borderRadius: theme.shape.borderRadius,\n    },\n    title: {\n        margin: '4px auto 4px 10px'\n    },\n    content: {\n        position: 'absolute',\n        top: 40,\n        bottom: theme.spacing(1),\n        left: theme.spacing(1),\n        right: theme.spacing(1),\n        overflow: 'hidden',\n    }\n}));\n\nfunction Panel({title, pos, children}) {\n    const classes = useStyles();\n\n    return <div className={classes.panel}\n                style={pos}>\n        <Typography variant={\"h6\"}\n                    className={classes.title}>{title}</Typography>\n        <div className={classes.content}>\n            {children}\n        </div>\n    </div>\n}\n\nexport default inject()(observer(Panel));\n","import React, {useRef} from 'react';\nimport {makeStyles} from \"@material-ui/core\";\nimport {inject, observer} from \"mobx-react\";\nimport {useSize} from \"ahooks\";\n\nconst useStyles = makeStyles(theme => ({\n    outerArea: {\n        position: 'relative',\n        width: '100%',\n        height: '100%',\n    },\n    innerContainer: {\n        position: 'absolute',\n        left: '50%',\n        top: '50%',\n        transform: 'translate(-50%, -50%)'\n    },\n}));\n\nfunction getMaxBox(width, height, ratio) {\n    if (!width || !height || !ratio) return [0, 0];\n\n    if (height * ratio > width) return [width, width / ratio];\n    else return [height * ratio, height];\n}\n\nfunction AspectRatioKeeper({ratio, children}) {\n    const classes = useStyles();\n    const rootRef = useRef();\n    const {width, height} = useSize(rootRef);\n\n    const [ctnW, ctnH] = getMaxBox(width, height, ratio);\n\n    return <div className={classes.outerArea}\n                ref={rootRef}>\n        <div className={classes.innerContainer}\n             style={{\n                 width: ctnW,\n                 height: ctnH,\n             }}>\n            {children}\n        </div>\n    </div>\n}\n\nexport default inject()(observer(AspectRatioKeeper));\n","import React from 'react';\nimport {Backdrop, CircularProgress, makeStyles} from \"@material-ui/core\";\nimport {inject, observer} from \"mobx-react\";\n\nconst useStyles = makeStyles(theme => ({\n    backdrop: {\n        zIndex: theme.zIndex.drawer + 1,\n        color: '#fff',\n    }\n}));\n\nfunction Waiting({store}) {\n    const classes = useStyles();\n\n    return <Backdrop className={classes.backdrop} open={store.waiting}>\n        <CircularProgress color=\"inherit\" />\n    </Backdrop>\n}\n\nexport default inject('store')(observer(Waiting));\n","import { inject, observer } from \"mobx-react\";\nimport { Typography, Dialog, DialogTitle, DialogContent, DialogContentText } from \"@material-ui/core\";\nimport packageJson from \"../../../package.json\";\n\n\nfunction Introduction({ store }) {\n\n\n\n\treturn <Dialog\n\t\tonClose={store.handleReadMeClose}\n\t\topen={store.isReadMeOpen}\n\t\tmaxWidth='lg'\n\t\tfullWidth>\n\t\t<DialogTitle>Introduction to KB4VA Specification</DialogTitle>\n\t\t<DialogContent>\n\t\t\t<embed \n\t\t\t\tsrc={packageJson.homepage + \"/codebook.pdf#toolbar=0&navpanes=0&scrollbar=0\"}\n\t\t\t\tstyle={{width: '100%', height: '800px'}}\n\t\t\t></embed>\n\t\t\t{/* <DialogContentText>\n\t\t\t\tHere is the introduction to KB4VA specifications, including analytical task specifications and design specification.\n\t\t\t</DialogContentText>\n\t\t\t<Typography variant='h5'>Analytical Tasks</Typography>\n\t\t\t<DialogContentText>\n\t\t\t\tThe categorization of analytical tasks is based on Brehmer M, Munzner T. A multi-level typology of abstract visualization tasks[J]. IEEE transactions on visualization and computer graphics, 2013, 19(12): 2376-2385. Specifically, a task is described as a pair of \"action\" and \"target\".\n\t\t\t</DialogContentText>\n\t\t\t<img src={process.env.PUBLIC_URL + \"/action-target.png\"} style={{maxWidth: '800px'}}></img>\n\t\t\t<DialogContentText>\n\t\t\tThe Figure is from Munzner T. Visualization analysis and design[M]. CRC press, 2014. Page 46 and Page 56.\n\t\t\t</DialogContentText>\n\t\t\t<Typography variant='h6'>Actions</Typography>\n\t\t\t<DialogContentText>\n\t\t\t\tThe following definitions of actions are directly quoted from Brehmer and Munzner's multi-level typology.\n\t\t\t</DialogContentText>\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t\t<b>Consume</b>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li><b>Present</b> refers to \"the use of visualization for the succinct communication of information, for telling a story with data, guiding an audience through a series of cognitive operations\".</li>\n\t\t\t\t\t\t<li><b>Discover</b> is \"about the generation and verification of hypotheses, associated with modes of scientific inquiry\".</li>\n\t\t\t\t\t\t<li><b>Enjoy</b> refers to “casual encounters with visualization”</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<b>Produce</b>: We use produce in reference to \"tasks in which the intent is to generate new artifacts, including transformed or derived data, annotations, recorded visualization interactions, or screenshots of static visualizations\".\n\t\t\t\t</li>\n\n\t\t\t\t<li>\n\t\t\t\t\t<b>Search</b>: Search includes four different types which is categorized based on the targets and locations.\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>Lookup: target known, location known</li>\n\t\t\t\t\t\t<li>Browse: target unknown, location known</li>\n\t\t\t\t\t\t<li>Locate: target known, location unknown</li>\n\t\t\t\t\t\t<li>Explore: target unknown, location unknown</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<b>Query</b>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>Identify: \"returns characteristics or reference for a target\"</li>\n\t\t\t\t\t\t<li>Compare: \"returns characteristics or reference for two or multiple targets\"</li>\n\t\t\t\t\t\t<li>Summarize: \"returns characteristics or reference for a whole set of targets\"</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t</ul> */}\n\t\t</DialogContent>\n\t</Dialog>\n}\n\nexport default inject('store')(observer(Introduction));","import { inject, observer } from \"mobx-react\";\nimport FigureViewer from \"./views/FigureViewer\";\nimport { AppBar, Button, makeStyles, Toolbar, Typography, useTheme } from \"@material-ui/core\";\n// import DialogContent from '@mui/material/DialogContent';\n// import DialogContentText from '@mui/material/DialogContentText';\nimport QueryPanel from \"./views/QueryPanel\";\nimport RecommendationsPanel from \"./views/RecommendationsPanel\";\nimport Panel from \"./components/Panel\";\nimport R from \"../res\";\nimport AspectRatioKeeper from \"./components/AspectRatioKeeper\";\nimport Waiting from \"./components/Waiting\";\nimport Introduction from \"./views/Introduction\";\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        width: '100vw',\n        height: '100vh',\n        backgroundColor: theme.palette.primary.light,\n    },\n    content: {\n        position: 'relative',\n        width: '100vw',\n        height: 'calc(100vh - 48px)',\n    },\n    flex: {\n        flex: 1,\n    }\n}));\n\nfunction App({ store }) {\n    const classes = useStyles();\n    const theme = useTheme();\n\n    return <div className={classes.root}>\n        <AppBar position=\"static\">\n            <Toolbar variant=\"dense\">\n                <Typography variant=\"h5\" color=\"inherit\" component=\"div\">{R.strings.systemName}</Typography>\n                <div className={classes.flex} />\n                <Button color={\"inherit\"} onClick={store.handleReadMeOpen}>ReadMe</Button>\n                <Introduction/>\n            </Toolbar>\n        </AppBar>\n        <div className={classes.content}>\n            <AspectRatioKeeper ratio={1920 / 1032}>\n                <Panel title=\"Query Panel\"\n                    pos={{\n                        top: theme.spacing(1),\n                        bottom: theme.spacing(1),\n                        left: theme.spacing(1),\n                        width: 500,\n                    }}\n                    bgColor={theme.palette.primary.light}>\n                    <QueryPanel />\n                </Panel>\n                <Panel title={`Retrieved Visualizations: ${store.recommendations.length} found`}\n                    pos={{\n                        top: theme.spacing(1),\n                        bottom: `${theme.spacing(2)}px`,\n                        left: theme.spacing(2) + 500,\n                        right: theme.spacing(1),\n                    }}\n                    bgColor={theme.palette.primary.light}>\n                    <RecommendationsPanel />\n                </Panel>\n                {/* <Panel title=\"Selected Visualizations\"\n                       pos={{\n                           height: '30%',\n                           bottom: theme.spacing(1),\n                           left: theme.spacing(2) + 500,\n                           right: theme.spacing(1),\n                       }}>\n                    <ViewList/>\n                </Panel> */}\n            </AspectRatioKeeper>\n        </div>\n        <FigureViewer />\n        {/* <TableViewer/> */}\n        <Waiting />\n    </div>;\n}\n\nexport default inject(\"store\")(observer(App));\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app/App';\nimport {Provider} from \"mobx-react\";\nimport store from \"./store\";\nimport {createTheme, CssBaseline, MuiThemeProvider} from \"@material-ui/core\";\nimport R from \"./res\";\n\nReactDOM.render(\n  <React.StrictMode>\n      <Provider store={store}>\n          <MuiThemeProvider theme={createTheme(R.theme)}>\n              <CssBaseline/>\n              <App />\n          </MuiThemeProvider>\n      </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}